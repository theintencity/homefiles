<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0) on Tue Dec 15 20:03:59 PST 2009 -->
<TITLE>
Database
</TITLE>

<META NAME="date" CONTENT="2009-12-15">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Database";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Database.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../db/FileItem.html" title="class in db"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?db/Database.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Database.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
db</FONT>
<BR>
Class Database</H2>
<PRE>
java.lang.Object
  <IMG SRC="../resources/inherit.gif" ALT="extended by "><B>db.Database</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>Database</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
The Database class implements a database and provides API methods to add, modify,
 search, export and import.
 
 All the methods are thread safe. The add, modify and importFrom use a write lock.
 The search and export use a read-lock.
 
 The actual API method names are as follows:
  add: 
        add(user-name, device-name, <File>...</File>)
  modify: 
        modify(user-name, device-name, old <File/>, new <File/>)
  search: 
        getFiles(user-name, device-name)
        findFiles(user-name, device-name, file-name) 
        matchFiles(user-name, device-name, file-name-substring)
        modifiedFiles(user-name, device-name, last-modified-after)
        search(XPath expression)
  export: 
        exportTo(file-name)
  import: 
        importFrom(file-name)
  
 The getFiles, findFiles, matchFiles and modifiedFiles functions handle the
 case when deviceName is "all".
 
 A new set of API methods getFilesAlt, findFilesAlt, matchFilesAlt and modifiedFilesAlt
 are also defined which return the filelist inside the device element and the top
 level element is Devices. This gives the device information to the client. Note
 that these API return clone of the nodes hence changes to return value is not
 updated on database, unlike the previous APIs.
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Mamta</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#dirty">dirty</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;org.w3c.dom.Document</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#doc">doc</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;javax.xml.parsers.DocumentBuilder</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#docBuilder">docBuilder</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;javax.xml.parsers.DocumentBuilderFactory</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#docFactory">docFactory</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#localdevice">localdevice</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../db/MyReadWriteLock.html" title="class in db">MyReadWriteLock</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#lock">lock</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;<A HREF="../db/Database.html" title="class in db">Database</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#singleton">singleton</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;javax.xml.xpath.XPathFactory</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#xpathFactory">xpathFactory</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private </CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#Database()">Database</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construct a new Database object, and create various XML and XPath related
 factory objects.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#add(java.lang.String, java.lang.String, org.w3c.dom.Node)">add</A></B>(java.lang.String&nbsp;userName,
    java.lang.String&nbsp;deviceName,
    org.w3c.dom.Node&nbsp;fileNode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add a new fileNode for the given userName and deviceName.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#addUsername(java.lang.String)">addUsername</A></B>(java.lang.String&nbsp;username)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add the given username in the database if it is not already there.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.NodeList</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#containFiles(java.lang.String, java.lang.String, java.lang.String)">containFiles</A></B>(java.lang.String&nbsp;userName,
             java.lang.String&nbsp;deviceName,
             java.lang.String&nbsp;match)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search all the files for the given user and device, for which the file name
 contains the given matching sub-string.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#containFilesAlt(java.lang.String, java.lang.String, java.lang.String)">containFilesAlt</A></B>(java.lang.String&nbsp;userName,
                java.lang.String&nbsp;deviceName,
                java.lang.String&nbsp;match)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#exportTo(java.lang.String)">exportTo</A></B>(java.lang.String&nbsp;fileName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Export the current XML database to a file using formatted XML.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Document</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getDoc()">getDoc</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is needed for creating a new Node from this document.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.NodeList</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getFiles(java.lang.String, java.lang.String)">getFiles</A></B>(java.lang.String&nbsp;userName,
         java.lang.String&nbsp;deviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search all the files for a given user and device.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getFilesAlt(java.lang.String, java.lang.String)">getFilesAlt</A></B>(java.lang.String&nbsp;userName,
            java.lang.String&nbsp;deviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../db/Database.html" title="class in db">Database</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getInstance()">getInstance</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The singleton instance of the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getLocalDevice()">getLocalDevice</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The getter for localdevice name property.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.List&lt;<A HREF="../db/LocalDir.html" title="class in db">LocalDir</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getLocalDir()">getLocalDir</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get a list of all the top-level LocalDir, one per user.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getUserLocalDir(java.lang.String)">getUserLocalDir</A></B>(java.lang.String&nbsp;username)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get a top-level LocalDir, for the given user.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#getVersion(java.lang.String)">getVersion</A></B>(java.lang.String&nbsp;deviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the version of that device.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#importFrom(java.lang.String)">importFrom</A></B>(java.lang.String&nbsp;fileName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Import the data from the supplied XML file, and replace the local database
 to reflect the database imported from that file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#incrVersion(java.lang.String)">incrVersion</A></B>(java.lang.String&nbsp;deviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Increment the version for that device by 1.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#isDirty()">isDirty</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Whether the database is dirty (modified?) since last update interval.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.NodeList</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#matchFiles(java.lang.String, java.lang.String, java.lang.String)">matchFiles</A></B>(java.lang.String&nbsp;userName,
           java.lang.String&nbsp;deviceName,
           java.lang.String&nbsp;fileName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search all the files for the given user and device, for which the file name
 is same as the supplied fileName.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#matchFilesAlt(java.lang.String, java.lang.String, java.lang.String)">matchFilesAlt</A></B>(java.lang.String&nbsp;userName,
              java.lang.String&nbsp;deviceName,
              java.lang.String&nbsp;fileName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.NodeList</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#modifiedFiles(java.lang.String, java.lang.String, java.util.Date)">modifiedFiles</A></B>(java.lang.String&nbsp;userName,
              java.lang.String&nbsp;deviceName,
              java.util.Date&nbsp;lastModified)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search all the files that are modified after the given lastModified date,
 for the given user and device.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#modifiedFilesAlt(java.lang.String, java.lang.String, java.util.Date)">modifiedFilesAlt</A></B>(java.lang.String&nbsp;userName,
                 java.lang.String&nbsp;deviceName,
                 java.util.Date&nbsp;lastModified)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#modify(java.lang.String, java.lang.String, org.w3c.dom.Node, org.w3c.dom.Node)">modify</A></B>(java.lang.String&nbsp;userName,
       java.lang.String&nbsp;deviceName,
       org.w3c.dom.Node&nbsp;oldFileNode,
       org.w3c.dom.Node&nbsp;newFileNode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modify the oldFileNode with the newFileNode for the given userName and deviceName.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#printNode(org.w3c.dom.Node, java.io.OutputStream)">printNode</A></B>(org.w3c.dom.Node&nbsp;node,
          java.io.OutputStream&nbsp;stream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print the XML node using formatted XML.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#printNodes(org.w3c.dom.NodeList, java.io.OutputStream)">printNodes</A></B>(org.w3c.dom.NodeList&nbsp;nodes,
           java.io.OutputStream&nbsp;stream)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print a NodeList to OutputStream using XML OutputFormat in UTF-8 encoding and
 using indentation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#resetDirty()">resetDirty</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reset the dirty flag for the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.NodeList</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#search(java.lang.String)">search</A></B>(java.lang.String&nbsp;query)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search the document using given XPath query string and returns a NodeList
 containing matching nodes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;org.w3c.dom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#searchAlt(java.lang.String, java.lang.String)">searchAlt</A></B>(java.lang.String&nbsp;deviceQuery,
          java.lang.String&nbsp;fileQuery)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search the document using given XPath query string and returns a NodeList
 containing matching nodes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#setDeviceStatus(java.lang.String, java.lang.String)">setDeviceStatus</A></B>(java.lang.String&nbsp;devicename,
                java.lang.String&nbsp;status)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the device status.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#setDirty()">setDirty</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the dirty flag for the database so that metadata is refreshed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#setLocalDevice(java.lang.String)">setLocalDevice</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The setter for localdevice name property.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#setUserLocalDir(java.lang.String, java.lang.String)">setUserLocalDir</A></B>(java.lang.String&nbsp;userName,
                java.lang.String&nbsp;localDir)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the localDir for the given user.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../db/Database.html#update(org.w3c.dom.Document)">update</A></B>(org.w3c.dom.Document&nbsp;other)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Update the database using a metadata update from another device.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="docFactory"><!-- --></A><H3>
docFactory</H3>
<PRE>
private javax.xml.parsers.DocumentBuilderFactory <B>docFactory</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="docBuilder"><!-- --></A><H3>
docBuilder</H3>
<PRE>
private javax.xml.parsers.DocumentBuilder <B>docBuilder</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="doc"><!-- --></A><H3>
doc</H3>
<PRE>
private org.w3c.dom.Document <B>doc</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="localdevice"><!-- --></A><H3>
localdevice</H3>
<PRE>
private java.lang.String <B>localdevice</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="dirty"><!-- --></A><H3>
dirty</H3>
<PRE>
private boolean <B>dirty</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="xpathFactory"><!-- --></A><H3>
xpathFactory</H3>
<PRE>
private javax.xml.xpath.XPathFactory <B>xpathFactory</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="lock"><!-- --></A><H3>
lock</H3>
<PRE>
private <A HREF="../db/MyReadWriteLock.html" title="class in db">MyReadWriteLock</A> <B>lock</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="singleton"><!-- --></A><H3>
singleton</H3>
<PRE>
private static <A HREF="../db/Database.html" title="class in db">Database</A> <B>singleton</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Database()"><!-- --></A><H3>
Database</H3>
<PRE>
private <B>Database</B>()
          throws javax.xml.parsers.ParserConfigurationException</PRE>
<DL>
<DD>Construct a new Database object, and create various XML and XPath related
 factory objects.
<P>
<DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.parsers.ParserConfigurationException</CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getInstance()"><!-- --></A><H3>
getInstance</H3>
<PRE>
public static <A HREF="../db/Database.html" title="class in db">Database</A> <B>getInstance</B>()</PRE>
<DL>
<DD>The singleton instance of the database.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setLocalDevice(java.lang.String)"><!-- --></A><H3>
setLocalDevice</H3>
<PRE>
public void <B>setLocalDevice</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD>The setter for localdevice name property.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getLocalDevice()"><!-- --></A><H3>
getLocalDevice</H3>
<PRE>
public java.lang.String <B>getLocalDevice</B>()</PRE>
<DL>
<DD>The getter for localdevice name property.
<P>
<DD><DL>

<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="isDirty()"><!-- --></A><H3>
isDirty</H3>
<PRE>
public boolean <B>isDirty</B>()</PRE>
<DL>
<DD>Whether the database is dirty (modified?) since last update interval.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="resetDirty()"><!-- --></A><H3>
resetDirty</H3>
<PRE>
public void <B>resetDirty</B>()</PRE>
<DL>
<DD>Reset the dirty flag for the database.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setDirty()"><!-- --></A><H3>
setDirty</H3>
<PRE>
public void <B>setDirty</B>()</PRE>
<DL>
<DD>Set the dirty flag for the database so that metadata is refreshed.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="importFrom(java.lang.String)"><!-- --></A><H3>
importFrom</H3>
<PRE>
public void <B>importFrom</B>(java.lang.String&nbsp;fileName)
                throws org.xml.sax.SAXException,
                       java.io.IOException,
                       java.lang.InterruptedException</PRE>
<DL>
<DD>Import the data from the supplied XML file, and replace the local database
 to reflect the database imported from that file.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fileName</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>org.xml.sax.SAXException</CODE>
<DD><CODE>java.io.IOException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="exportTo(java.lang.String)"><!-- --></A><H3>
exportTo</H3>
<PRE>
public void <B>exportTo</B>(java.lang.String&nbsp;fileName)
              throws java.io.IOException,
                     java.lang.InterruptedException</PRE>
<DL>
<DD>Export the current XML database to a file using formatted XML.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>fileName</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="search(java.lang.String)"><!-- --></A><H3>
search</H3>
<PRE>
public org.w3c.dom.NodeList <B>search</B>(java.lang.String&nbsp;query)
                            throws javax.xml.xpath.XPathExpressionException,
                                   java.lang.InterruptedException</PRE>
<DL>
<DD>Search the document using given XPath query string and returns a NodeList
 containing matching nodes. This is used only for searching nodes. This is
 used by other high-level API methods such as getFiles, matchFiles, etc.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>query</CODE> - 
<DT><B>Returns:</B><DD>NodeList
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="matchFiles(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
matchFiles</H3>
<PRE>
public org.w3c.dom.NodeList <B>matchFiles</B>(java.lang.String&nbsp;userName,
                                       java.lang.String&nbsp;deviceName,
                                       java.lang.String&nbsp;fileName)
                                throws javax.xml.xpath.XPathExpressionException,
                                       java.lang.InterruptedException</PRE>
<DL>
<DD>Search all the files for the given user and device, for which the file name
 is same as the supplied fileName.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - <DD><CODE>fileName</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="containFiles(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
containFiles</H3>
<PRE>
public org.w3c.dom.NodeList <B>containFiles</B>(java.lang.String&nbsp;userName,
                                         java.lang.String&nbsp;deviceName,
                                         java.lang.String&nbsp;match)
                                  throws javax.xml.xpath.XPathExpressionException,
                                         java.lang.InterruptedException</PRE>
<DL>
<DD>Search all the files for the given user and device, for which the file name
 contains the given matching sub-string.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - <DD><CODE>match</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="modifiedFiles(java.lang.String, java.lang.String, java.util.Date)"><!-- --></A><H3>
modifiedFiles</H3>
<PRE>
public org.w3c.dom.NodeList <B>modifiedFiles</B>(java.lang.String&nbsp;userName,
                                          java.lang.String&nbsp;deviceName,
                                          java.util.Date&nbsp;lastModified)
                                   throws javax.xml.xpath.XPathExpressionException,
                                          java.lang.InterruptedException</PRE>
<DL>
<DD>Search all the files that are modified after the given lastModified date,
 for the given user and device.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - <DD><CODE>lastModified</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getFiles(java.lang.String, java.lang.String)"><!-- --></A><H3>
getFiles</H3>
<PRE>
public org.w3c.dom.NodeList <B>getFiles</B>(java.lang.String&nbsp;userName,
                                     java.lang.String&nbsp;deviceName)
                              throws javax.xml.xpath.XPathExpressionException,
                                     java.lang.InterruptedException</PRE>
<DL>
<DD>Search all the files for a given user and device.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="searchAlt(java.lang.String, java.lang.String)"><!-- --></A><H3>
searchAlt</H3>
<PRE>
public org.w3c.dom.Node <B>searchAlt</B>(java.lang.String&nbsp;deviceQuery,
                                  java.lang.String&nbsp;fileQuery)
                           throws javax.xml.xpath.XPathExpressionException,
                                  java.lang.InterruptedException</PRE>
<DL>
<DD>Search the document using given XPath query string and returns a NodeList
 containing matching nodes. The difference between this and previous search
 function is that, this returns XML with device hierarchy so that top level
 element is Devices, with list of Device, and each Device has a FileList.
 The previous search function returns FileList hence the device information is
 lost in the result.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>deviceQuery</CODE> - to select the devices<DD><CODE>fileQuery</CODE> - to select the files within selected devices
<DT><B>Returns:</B><DD>NodeList
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="matchFilesAlt(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
matchFilesAlt</H3>
<PRE>
public org.w3c.dom.Node <B>matchFilesAlt</B>(java.lang.String&nbsp;userName,
                                      java.lang.String&nbsp;deviceName,
                                      java.lang.String&nbsp;fileName)
                               throws javax.xml.xpath.XPathExpressionException,
                                      java.lang.InterruptedException</PRE>
<DL>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="containFilesAlt(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
containFilesAlt</H3>
<PRE>
public org.w3c.dom.Node <B>containFilesAlt</B>(java.lang.String&nbsp;userName,
                                        java.lang.String&nbsp;deviceName,
                                        java.lang.String&nbsp;match)
                                 throws javax.xml.xpath.XPathExpressionException,
                                        java.lang.InterruptedException</PRE>
<DL>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="modifiedFilesAlt(java.lang.String, java.lang.String, java.util.Date)"><!-- --></A><H3>
modifiedFilesAlt</H3>
<PRE>
public org.w3c.dom.Node <B>modifiedFilesAlt</B>(java.lang.String&nbsp;userName,
                                         java.lang.String&nbsp;deviceName,
                                         java.util.Date&nbsp;lastModified)
                                  throws javax.xml.xpath.XPathExpressionException,
                                         java.lang.InterruptedException</PRE>
<DL>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getFilesAlt(java.lang.String, java.lang.String)"><!-- --></A><H3>
getFilesAlt</H3>
<PRE>
public org.w3c.dom.Node <B>getFilesAlt</B>(java.lang.String&nbsp;userName,
                                    java.lang.String&nbsp;deviceName)
                             throws javax.xml.xpath.XPathExpressionException,
                                    java.lang.InterruptedException</PRE>
<DL>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="add(java.lang.String, java.lang.String, org.w3c.dom.Node)"><!-- --></A><H3>
add</H3>
<PRE>
public void <B>add</B>(java.lang.String&nbsp;userName,
                java.lang.String&nbsp;deviceName,
                org.w3c.dom.Node&nbsp;fileNode)
         throws javax.xml.xpath.XPathExpressionException,
                javax.naming.NamingException,
                java.lang.InterruptedException</PRE>
<DL>
<DD>Add a new fileNode for the given userName and deviceName. If the file already
 exists (with same name and path), then an exception is thrown. Otherwise a
 new <File/> element is added in the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - <DD><CODE>fileNode</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>javax.naming.NamingException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="modify(java.lang.String, java.lang.String, org.w3c.dom.Node, org.w3c.dom.Node)"><!-- --></A><H3>
modify</H3>
<PRE>
public void <B>modify</B>(java.lang.String&nbsp;userName,
                   java.lang.String&nbsp;deviceName,
                   org.w3c.dom.Node&nbsp;oldFileNode,
                   org.w3c.dom.Node&nbsp;newFileNode)
            throws javax.xml.xpath.XPathExpressionException,
                   javax.naming.NameNotFoundException,
                   java.lang.InterruptedException</PRE>
<DL>
<DD>Modify the oldFileNode with the newFileNode for the given userName and deviceName.
 If a matching entry is not found, then an exception is thrown indicating what
 was not found (user doesn't exist, or device doesn't exist, or old file
 doesn' exists.) The inside elements (Path, Name, Size, etc.) of File element
 are modified in the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>userName</CODE> - <DD><CODE>deviceName</CODE> - <DD><CODE>oldFileNode</CODE> - <DD><CODE>newFileNode</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>javax.naming.NameNotFoundException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="printNodes(org.w3c.dom.NodeList, java.io.OutputStream)"><!-- --></A><H3>
printNodes</H3>
<PRE>
public static void <B>printNodes</B>(org.w3c.dom.NodeList&nbsp;nodes,
                              java.io.OutputStream&nbsp;stream)
                       throws java.io.IOException</PRE>
<DL>
<DD>Print a NodeList to OutputStream using XML OutputFormat in UTF-8 encoding and
 using indentation. The Driver calls this to print the result of search queries
 to System.out OutputStream.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nodes</CODE> - <DD><CODE>stream</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="printNode(org.w3c.dom.Node, java.io.OutputStream)"><!-- --></A><H3>
printNode</H3>
<PRE>
public static void <B>printNode</B>(org.w3c.dom.Node&nbsp;node,
                             java.io.OutputStream&nbsp;stream)
                      throws java.io.IOException</PRE>
<DL>
<DD>Print the XML node using formatted XML.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>node</CODE> - <DD><CODE>stream</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="addUsername(java.lang.String)"><!-- --></A><H3>
addUsername</H3>
<PRE>
public void <B>addUsername</B>(java.lang.String&nbsp;username)
                 throws java.lang.InterruptedException,
                        javax.xml.xpath.XPathExpressionException,
                        javax.naming.NamingException</PRE>
<DL>
<DD>Add the given username in the database if it is not already there.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.InterruptedException</CODE>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>javax.naming.NamingException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setDeviceStatus(java.lang.String, java.lang.String)"><!-- --></A><H3>
setDeviceStatus</H3>
<PRE>
public void <B>setDeviceStatus</B>(java.lang.String&nbsp;devicename,
                            java.lang.String&nbsp;status)
                     throws java.lang.InterruptedException,
                            javax.xml.xpath.XPathExpressionException</PRE>
<DL>
<DD>Set the device status.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.InterruptedException</CODE>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getLocalDir()"><!-- --></A><H3>
getLocalDir</H3>
<PRE>
public java.util.List&lt;<A HREF="../db/LocalDir.html" title="class in db">LocalDir</A>&gt; <B>getLocalDir</B>()
                                     throws javax.xml.xpath.XPathExpressionException,
                                            java.lang.InterruptedException</PRE>
<DL>
<DD>Get a list of all the top-level LocalDir, one per user.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getUserLocalDir(java.lang.String)"><!-- --></A><H3>
getUserLocalDir</H3>
<PRE>
public java.lang.String <B>getUserLocalDir</B>(java.lang.String&nbsp;username)
                                 throws javax.xml.xpath.XPathExpressionException,
                                        java.lang.InterruptedException</PRE>
<DL>
<DD>Get a top-level LocalDir, for the given user.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setUserLocalDir(java.lang.String, java.lang.String)"><!-- --></A><H3>
setUserLocalDir</H3>
<PRE>
public void <B>setUserLocalDir</B>(java.lang.String&nbsp;userName,
                            java.lang.String&nbsp;localDir)
                     throws javax.xml.xpath.XPathExpressionException,
                            java.lang.InterruptedException</PRE>
<DL>
<DD>Set the localDir for the given user. It also clears the database so that
 next update cycle can re-create the database with the new directory.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="incrVersion(java.lang.String)"><!-- --></A><H3>
incrVersion</H3>
<PRE>
public void <B>incrVersion</B>(java.lang.String&nbsp;deviceName)
                 throws javax.xml.xpath.XPathExpressionException,
                        java.lang.InterruptedException</PRE>
<DL>
<DD>Increment the version for that device by 1. If the previous value is
 missing, assume it 0, and then increment.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>deviceName</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getVersion(java.lang.String)"><!-- --></A><H3>
getVersion</H3>
<PRE>
public long <B>getVersion</B>(java.lang.String&nbsp;deviceName)
                throws javax.xml.xpath.XPathExpressionException,
                       java.lang.InterruptedException</PRE>
<DL>
<DD>Get the version of that device. In case of error, it returns 0.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>deviceName</CODE> - 
<DT><B>Returns:</B><DD>
<DT><B>Throws:</B>
<DD><CODE>javax.xml.xpath.XPathExpressionException</CODE>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getDoc()"><!-- --></A><H3>
getDoc</H3>
<PRE>
public org.w3c.dom.Document <B>getDoc</B>()</PRE>
<DL>
<DD>This is needed for creating a new Node from this document.
<P>
<DD><DL>

<DT><B>Returns:</B><DD></DL>
</DD>
</DL>
<HR>

<A NAME="update(org.w3c.dom.Document)"><!-- --></A><H3>
update</H3>
<PRE>
public void <B>update</B>(org.w3c.dom.Document&nbsp;other)
            throws java.lang.InterruptedException</PRE>
<DL>
<DD>Update the database using a metadata update from another device.
 The update is done by using the version information. The metadata
 is the Devices element with a localdevice attribute identifying the
 sender.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.InterruptedException</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Database.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../db/FileItem.html" title="class in db"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html?db/Database.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Database.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
